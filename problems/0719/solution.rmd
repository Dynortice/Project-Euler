---
title: "Problem 719"
author: "Dynortice"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    theme: readable
---
## Number Splitting

We define an $S$-number to be a natural number, $n$, that is a perfect square and its square root can be obtained by splitting the decimal representation of $n$ into $2$ or more numbers then adding the numbers.

For example, $81$ is an $S$-number because $\sqrt{81} = 8 + 1$

$6724$ is an $S$-number: $\sqrt{6724} = 6 + 72 + 4$

$8281$ is an $S$-number: $\sqrt{8281} = 8 + 2 + 81 = 82 + 8 + 1$

$9801$ is an $S$-number: $\sqrt{9801} = 98 + 0 + 1$

Further we define $T(N)$ to be the sum of all $S$ numbers $n \le N$. You are given $T(10 ^ 4) = 41333$.

Find $T(10 ^ {12})$.

## Solution
```{r, message = FALSE}
library(microbenchmark)
library(bit64)
```

```{r}
compute <- function(n) {
    is.s_number <- function(a, b) {
        if (a > b) {
            return(FALSE)
        } else if (a == b) {
            return(TRUE)
        }
        modulo <- 10
        while (modulo < b) {
            quotient <- b %/% modulo
            remainder <- b %% modulo
            if (remainder < a & is.s_number(a - remainder, quotient)) {
                return(TRUE)
            }
            modulo <- modulo * 10
        }
        return(FALSE)
    }
    result <- 0
    for (i in 2:n) {
        number <- as.integer64(i)
        if (is.s_number(number, number * number)) {
            result <- result + number * number
        }
    }
    return(result)
}
```

```{r}
compute(10 ^ 2)
```
```{r}
compute(10 ^ 6)
```

```{r}
microbenchmark(compute(10 ^ 6), times = 1)
```