---
title: "Problem 44"
author: "Dynortice"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    theme: readable
---
## Pentagon numbers

Pentagonal numbers are generated by the formula, $P_n = \frac{n (3n - 1)}{2}$. The first ten pentagonal numbers are:

$$1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...$$

It can be seen that $P_4 + P_7 = 22 + 70 = 92 = P_8$. However, their difference, $70 − 22 = 48$, is not pentagonal.

Find the pair of pentagonal numbers, $P_j$ and $P_k$, for which their sum and difference are pentagonal and $D = |P_k − P_j|$ is minimised; what is the value of $D$?

## Solution
Just need to check if number is pentagonal by next formula:

$$x = P_n = \frac{n (3n - 1)}{2}$$

$$\iff 0 = 3n^2 - n - 2x$$

$$\iff n_{1, 2} = \frac{1 \pm \sqrt{1 + 4 \times 3 \times 2x}}{2 \times 3} = \frac{1 \pm \sqrt{1 + 24x}}{6}$$

Thus $1 + 24x$ is a perfect square and $\sqrt{1 + 24x} \equiv 5 \mod(6)$
```{r}
library(microbenchmark)
setwd("../../")
source("euler/R/calculus.R")
```
```{r}
compute <- function() {
    pentagonals <- 1
    i <- 1
    j <- 1
    while (TRUE) {
        for (k in pentagonals) {
            if (is.pentagonal(pentagonals[i] - k) && is.pentagonal(abs(pentagonals[i] - 2 * k))) {
                return(abs(pentagonals[i] - 2 * k))
            }
        }
        j <- j + 3
        pentagonals <- c(pentagonals, pentagonals[i] + j)
        i <- i + 1
    }
}
```
```{r}
compute()
```
```{r}
microbenchmark(compute())
```
